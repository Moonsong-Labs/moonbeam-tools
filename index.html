<!DOCTYPE html>
<html>

<head>
    <title>Monitoring</title>
    <link rel="modulepreload" href="./dist/index.esm.js" charset="UTF-8"
        integrity="sha384-Rp+AJiqSkCwPajGgNf1TGdWRVDSgf5GtK1pgO7uPofbSxPVNaZ/wNdulNxKVaO6I" crossorigin="anonymous">
    <style>
        body {
            padding: 2rem;
        }

        pre {
            margin: 0;
        }
    </style>
</head>

<body>
    <div id="main-alphanet"></div>
    <div id="main-moonriver"></div>
    <div id="main-moonbeam"></div>
    <script type="module">
        import * as mbTools from "./dist/index.esm.js";
        const monitorNetwork = async (api, networkName) => {
            const pre = document.createElement("pre");
            const title = document.createElement("h2");
            title.append(networkName);
            const main = document.getElementById(`main-${networkName}`);
            main.appendChild(title);
            main.appendChild(pre);
            let previousBlockDetails = null;
            mbTools.listenBlocks(api, false, async (blockDetails) => {
                const line = `${mbTools.generateBlockDetailsLog(
                    blockDetails,
                    {},
                    previousBlockDetails
                )}\n`;
                pre.prepend(line);
                previousBlockDetails = blockDetails;
            });
            return api;
        };

        const start = async () => {
            const api = await mbTools.getApiFor({ network: "moonriver" });
            // You can also directly to the node using url
            // const api = await mbTools.getApiFor({ url: "ws://127.0.0.1:9944" });

            const networkName =
                mbTools.NETWORK_CHAIN_MAPPING[
                (await api.rpc.system.chain()).toString()
                ];
            monitorNetwork(api, networkName);
        };

        start();
    </script>
</body>

</html>